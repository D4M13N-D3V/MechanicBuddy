# =============================================================================
# MechanicBuddy Management System Helm Chart Values
# =============================================================================

# -----------------------------------------------------------------------------
# Global Configuration
# -----------------------------------------------------------------------------
global:
  # Base domain
  domain: "mechanicbuddy.app"
  # Image pull secrets
  imagePullSecrets: []

# -----------------------------------------------------------------------------
# Namespace
# -----------------------------------------------------------------------------
namespace: "mechanicbuddy-system"

# -----------------------------------------------------------------------------
# PostgreSQL (Management Database)
# -----------------------------------------------------------------------------
postgresql:
  instances: 1
  database: "mechanicbuddy_management"
  username: "management"
  storage:
    size: "10Gi"
    storageClass: "local-path"
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "500m"

# -----------------------------------------------------------------------------
# Management API (.NET)
# -----------------------------------------------------------------------------
managementApi:
  enabled: true
  replicas: 2
  image:
    repository: "ghcr.io/mechanicbuddy/management-api"
    tag: "latest"
    pullPolicy: "IfNotPresent"
  port: 15568
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "500m"
  # Kubernetes API access for tenant provisioning
  rbac:
    create: true
    clusterRole: true

# -----------------------------------------------------------------------------
# Management Portal (Next.js)
# -----------------------------------------------------------------------------
portal:
  enabled: true
  replicas: 2
  image:
    repository: "ghcr.io/mechanicbuddy/management-portal"
    tag: "latest"
    pullPolicy: "IfNotPresent"
  port: 3001
  resources:
    requests:
      memory: "128Mi"
      cpu: "50m"
    limits:
      memory: "256Mi"
      cpu: "250m"

# -----------------------------------------------------------------------------
# Stripe Configuration
# -----------------------------------------------------------------------------
stripe:
  # Publishable key (safe for client-side)
  publishableKey: ""
  # Secret key (stored in Kubernetes secret)
  secretKey: ""
  # Webhook secret (stored in Kubernetes secret)
  webhookSecret: ""
  # Price IDs for subscription tiers
  prices:
    free: ""           # Free tier price ID
    standard: ""       # $20/mechanic (2-10)
    growth: ""         # $15/mechanic (11-20)
    scale: ""          # $10/mechanic (21+)

# -----------------------------------------------------------------------------
# Email Configuration (Resend)
# -----------------------------------------------------------------------------
email:
  provider: "resend"
  apiKey: ""
  fromAddress: "noreply@mechanicbuddy.app"
  fromName: "MechanicBuddy"

# -----------------------------------------------------------------------------
# Cloudflare Configuration (for DNS automation)
# -----------------------------------------------------------------------------
cloudflare:
  enabled: false
  apiToken: ""
  zoneId: ""

# -----------------------------------------------------------------------------
# Super Admin Configuration
# -----------------------------------------------------------------------------
superAdmin:
  # Initial super admin credentials (set on first install)
  initialEmail: "admin@mechanicbuddy.app"
  initialPassword: ""  # Auto-generated if not set

# -----------------------------------------------------------------------------
# Ingress Configuration
# -----------------------------------------------------------------------------
ingress:
  enabled: true
  className: "nginx"
  annotations:
    nginx.ingress.kubernetes.io/proxy-body-size: "50m"
  hosts:
    # Main management portal
    - host: "mechanicbuddy.app"
      paths:
        - path: /
          pathType: Prefix
          service: portal
    # API subdomain
    - host: "api.mechanicbuddy.app"
      paths:
        - path: /
          pathType: Prefix
          service: management-api
  tls:
    enabled: true
    clusterIssuer: "letsencrypt-prod"

# -----------------------------------------------------------------------------
# Demo Cleanup (CronJob)
# -----------------------------------------------------------------------------
demoCleanup:
  enabled: true
  schedule: "0 3 * * *"  # Daily at 3 AM
  image:
    repository: "ghcr.io/mechanicbuddy/demo-cleanup"
    tag: "latest"

# -----------------------------------------------------------------------------
# Subscription Expiry Check (CronJob)
# -----------------------------------------------------------------------------
subscriptionExpiry:
  enabled: true
  schedule: "0 4 * * *"  # Daily at 4 AM

# -----------------------------------------------------------------------------
# Security Context
# -----------------------------------------------------------------------------
securityContext:
  runAsNonRoot: true
  runAsUser: 1000
  fsGroup: 1000

# -----------------------------------------------------------------------------
# Service Account
# -----------------------------------------------------------------------------
serviceAccount:
  create: true
  name: "mechanicbuddy-system"
  annotations: {}
